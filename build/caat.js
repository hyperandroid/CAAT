var CAAT=CAAT||{};function extend(a,b,c){var d=function(){},e;d.prototype=b.prototype;a.prototype=new d;a.prototype.constructor=a;a.superclass=b.prototype;if(b.prototype.constructor==Object.prototype.constructor)b.prototype.constructor=b;if(c)for(e in c)if(c.hasOwnProperty(e))a.prototype[e]=c[e]};var BrowserDetect={init:function(){this.browser=this.searchString(this.dataBrowser)||"An unknown browser";this.version=this.searchVersion(navigator.userAgent)||this.searchVersion(navigator.appVersion)||"an unknown version";this.OS=this.searchString(this.dataOS)||"an unknown OS"},searchString:function(a){for(var b=0;b<a.length;b++){var c=a[b].string,d=a[b].prop;this.versionSearchString=a[b].versionSearch||a[b].identity;if(c){if(c.indexOf(a[b].subString)!=-1)return a[b].identity}else if(d)return a[b].identity}},
searchVersion:function(a){var b=a.indexOf(this.versionSearchString);if(b!=-1)return parseFloat(a.substring(b+this.versionSearchString.length+1))},dataBrowser:[{string:navigator.userAgent,subString:"Chrome",identity:"Chrome"},{string:navigator.userAgent,subString:"OmniWeb",versionSearch:"OmniWeb/",identity:"OmniWeb"},{string:navigator.vendor,subString:"Apple",identity:"Safari",versionSearch:"Version"},{prop:window.opera,identity:"Opera"},{string:navigator.vendor,subString:"iCab",identity:"iCab"},{string:navigator.vendor,
subString:"KDE",identity:"Konqueror"},{string:navigator.userAgent,subString:"Firefox",identity:"Firefox"},{string:navigator.vendor,subString:"Camino",identity:"Camino"},{string:navigator.userAgent,subString:"Netscape",identity:"Netscape"},{string:navigator.userAgent,subString:"MSIE",identity:"Explorer",versionSearch:"MSIE"},{string:navigator.userAgent,subString:"Explorer",identity:"Explorer",versionSearch:"Explorer"},{string:navigator.userAgent,subString:"Gecko",identity:"Mozilla",versionSearch:"rv"},
{string:navigator.userAgent,subString:"Mozilla",identity:"Netscape",versionSearch:"Mozilla"}],dataOS:[{string:navigator.platform,subString:"Win",identity:"Windows"},{string:navigator.platform,subString:"Mac",identity:"Mac"},{string:navigator.userAgent,subString:"iPhone",identity:"iPhone/iPod"},{string:navigator.platform,subString:"Linux",identity:"Linux"}]};BrowserDetect.init();(function(){CAAT.Actor=function(){this.transformationMatrix=new CAAT.MatrixStack;this.rpoint=new CAAT.Point;this.behaviorList=[];this.lifecycleListenerList=[];this.screenBounds=new CAAT.Rectangle;return this};CAAT.Actor.prototype={lifecycleListenerList:null,behaviorList:null,parent:null,x:0,y:0,width:0,height:0,start_time:0,duration:Number.MAX_VALUE,transformationMatrix:null,rpoint:null,clip:false,scaleX:0,scaleY:0,scaleTX:0,scaleTY:0,scaleAnchor:0,rotationAngle:0,rotationX:0,rotationY:0,alpha:1,
isGlobalAlpha:false,frameAlpha:1,expired:false,discardable:false,pointed:false,mouseEnabled:true,ANCHOR_CENTER:0,ANCHOR_TOP:1,ANCHOR_BOTTOM:2,ANCHOR_LEFT:3,ANCHOR_RIGHT:4,ANCHOR_TOP_LEFT:5,ANCHOR_TOP_RIGHT:6,ANCHOR_BOTTOM_LEFT:7,ANCHOR_BOTTOM_RIGHT:8,fillStyle:null,strokeStyle:null,time:0,screenBounds:null,inFrame:false,addListener:function(a){this.lifecycleListenerList.push(a)},removeListener:function(a){for(var b=this.lifecycleListenerList.length;b--;)if(this.lifecycleListenerList[b]==a){this.lifecycleListenerList.splice(b,
1);return}},setGlobalAlpha:function(a){this.isGlobalAlpha=a;return this},fireEvent:function(a,b){for(var c=0;c<this.lifecycleListenerList.length;c++)this.lifecycleListenerList[c].actorLyfeCycleEvent(this,a,b)},setScreenBounds:function(){var a=[];a.push((new CAAT.Point).set(0,0));a.push((new CAAT.Point).set(this.width,this.height));a.push((new CAAT.Point).set(0,this.height));a.push((new CAAT.Point).set(this.width,0));for(var b=0;b<a.length;b++)this.transformCoord(a[b]);b=Number.MAX_VALUE;for(var c=
Number.MIN_VALUE,d=Number.MAX_VALUE,e=Number.MIN_VALUE,f=0;f<a.length;f++){if(a[f].x<b)b=a[f].x;if(a[f].x>c)c=a[f].x;if(a[f].y<d)d=a[f].y;if(a[f].y>e)e=a[f].y}this.screenBounds.x=b;this.screenBounds.y=d;this.screenBounds.width=c-b;this.screenBounds.height=e-d},setExpired:function(a){this.expired=true;this.fireEvent("expired",a);return this},enableEvents:function(a){this.mouseEnabled=a;return this},emptyBehaviorList:function(){this.behaviorList=[];return this},setFillStyle:function(a){this.fillStyle=
a;return this},setStrokeStyle:function(a){this.strokeStyle=a;return this},setPaint:function(a){return this.setFillStyle(a)},setAlpha:function(a){this.alpha=a;return this},resetTransform:function(){this.rotationY=this.rotationX=this.rotateAnchor=this.rotationAngle=0;this.scaleY=this.scaleX=1;this.scaleAnchor=this.scaleTY=this.scaleTX=0;return this},setFrameTime:function(a,b){this.start_time=a;this.duration=b;this.expired=false;return this},paint:function(a){a=a.crc;if(null!=this.parent&&null!=this.fillStyle){a.fillStyle=
this.pointed?"orange":this.fillStyle!=null?this.fillStyle:"white";a.fillRect(0,0,this.width,this.height)}if(null!=this.strokeStyle){a.strokeStyle=this.strokeStyle;a.strokeRect(0,0,this.width,this.height)}},setScale:function(a,b){this.setScaleAnchored(a,b,this.ANCHOR_CENTER);return this},getAnchor:function(a){var b=0,c=0;switch(a){case this.ANCHOR_CENTER:b=this.width/2;c=this.height/2;break;case this.ANCHOR_TOP:b=this.width/2;c=0;break;case this.ANCHOR_BOTTOM:b=this.width/2;c=this.height;break;case this.ANCHOR_LEFT:b=
0;c=this.height/2;break;case this.ANCHOR_RIGHT:b=this.width;c=this.height/2;break;case this.ANCHOR_TOP_RIGHT:b=this.width;c=0;break;case this.ANCHOR_BOTTOM_LEFT:b=0;c=this.height;break;case this.ANCHOR_BOTTOM_RIGHT:b=this.width;c=this.height;break;case this.ANCHOR_TOP_LEFT:c=b=0;break}return{x:b,y:c}},setScaleAnchored:function(a,b,c){this.scaleAnchor=c;c=this.getAnchor(this.scaleAnchor);this.scaleTX=c.x;this.scaleTY=c.y;this.scaleX=a;this.scaleY=b;return this},setRotation:function(a){this.setRotationAnchored(a,
this.width/2,this.height/2);return this},setRotationAnchored:function(a,b,c){this.rotationAngle=a;this.rotationX=b?b:0;this.rotationY=c?c:0;return this},setSize:function(a,b){this.width=a;this.height=b;return this},setBounds:function(a,b,c,d){this.x=a;this.y=b;this.width=c;this.height=d;return this},setLocation:function(a,b){this.x=a;this.y=b;return this},isInAnimationFrame:function(a){if(this.expired)return false;if(this.duration==Number.MAX_VALUE)return this.start_time<=a;if(a>this.start_time+this.duration){this.expired||
this.setExpired(a);return false}return this.start_time<=a&&a<this.start_time+this.duration},contains:function(a,b){return a>=0&&b>=0&&a<this.width&&b<this.height},create:function(){this.rotateAnchor=this.scaleAnchor=this.ANCHOR_CENTER;this.setScale(1,1);this.setRotation(0);this.behaviorList=[];return this},addBehavior:function(a){this.behaviorList.push(a);return this},removeBehaviour:function(a){for(var b=this.behaviorList.length;b--;)if(this.behaviorList[b]==a){this.behaviorList.splice(b,1);return}},
setDiscardable:function(a){this.discardable=a;return this},destroy:function(a){this.fireEvent("destroyed",a)},transformCoord:function(a){for(var b=this;!(b instanceof CAAT.Director);){b.transformationMatrix.transformCoord(a);b=b.parent}return a},inverseTransformCoord:function(a){for(var b=this;b;){b.transformationMatrix.inverseTransformCoord(a);b=b.parent}return a},findActorAtPosition:function(a){if(!this.mouseEnabled)return null;this.rpoint.set(a.x,a.y);this.transformationMatrix.inverseTransformCoord(this.rpoint);
return this.contains(this.rpoint.x,this.rpoint.y)?this:null},enableDrag:function(){this.my=this.mx=this.ay=this.ax=0;this.asy=this.asx=1;this.screeny=this.screenx=this.ara=0;this.mouseEnter=function(){this.ay=this.ax=-1;this.pointed=true;document.body.style.cursor="move"};this.mouseExit=function(){this.ay=this.ax=-1;this.pointed=false;document.body.style.cursor="default"};this.mouseMove=function(a){this.mx=a.point.x;this.my=a.point.y};this.mouseUp=function(){this.ay=this.ax=-1};this.mouseDrag=function(a){if(this.ax==
-1||this.ay==-1){this.ax=a.point.x;this.ay=a.point.y;this.asx=this.scaleX;this.asy=this.scaleY;this.ara=this.rotationAngle;this.screenx=a.screenPoint.x;this.screeny=a.screenPoint.y}if(a.isShiftDown()){var b=(a.screenPoint.x-this.screenx)/100,c=(a.screenPoint.y-this.screeny)/100;if(!a.isAltDown())c=b=a=Math.max(b,c);this.setScale(b+this.asx,c+this.asy)}else if(a.isControlDown())this.setRotation(-Math.atan2(a.screenPoint.x-this.screenx,a.screenPoint.y-this.screeny)+this.ara);else{this.x+=a.point.x-
this.ax;this.y+=a.point.y-this.ay;this.ax=a.point.x;this.ay=a.point.y}};return this},mouseClick:function(){},mouseDblClick:function(){},mouseEnter:function(){this.pointed=true},mouseExit:function(){this.pointed=false},mouseMove:function(){},mouseDown:function(){},mouseUp:function(){},mouseDrag:function(){},drawScreenBoundingBox:function(a){if(this.inFrame&&null!=this.screenBounds){a.crc.strokeStyle="red";a.crc.strokeRect(this.screenBounds.x,this.screenBounds.y,this.screenBounds.width,this.screenBounds.height)}},
animate:function(a,b){for(var c=0;c<this.behaviorList.length;c++)this.behaviorList[c].apply(b,this)},paintActor:function(a,b){if(!this.isInAnimationFrame(b))return this.inFrame=false;var c=a.crc;this.frameAlpha=this.parent.frameAlpha*this.alpha;c.globalAlpha=this.frameAlpha;this.transformationMatrix.prepareGraphics(c,this);this.setScreenBounds();if(this.clip){c.beginPath();c.rect(0,0,this.width,this.height);c.clip()}this.paint(a,b);return this.inFrame=true},endAnimate:function(){},initialize:function(a){if(a)for(var b in a)this[b]=
a[b];return this},setClip:function(a){this.clip=a;return this}}})();
(function(){CAAT.ActorContainer=function(){CAAT.ActorContainer.superclass.constructor.call(this);this.childrenList=[];return this};extend(CAAT.ActorContainer,CAAT.Actor,{childrenList:null,drawScreenBoundingBox:function(a,b){if(this.inFrame){for(var c=0;c<this.childrenList.length;c++)this.childrenList[c].drawScreenBoundingBox(a,b);CAAT.ActorContainer.superclass.drawScreenBoundingBox.call(this,a,b)}},emptyChildren:function(){this.childrenList=[];return this},paintActor:function(a,b){var c=a.crc;c.save();
if(!CAAT.ActorContainer.superclass.paintActor.call(this,a,b))return false;if(!this.isGlobalAlpha)this.frameAlpha=this.parent.frameAlpha;for(var d=0;d<this.childrenList.length;d++){c.save();this.childrenList[d].paintActor(a,b);c.restore()}c.restore();return true},animate:function(a,b){CAAT.ActorContainer.superclass.animate.call(this,a,b);var c;for(c=0;c<this.childrenList.length;c++)if(this.childrenList[c].isInAnimationFrame(b)){this.childrenList[c].time=b;this.childrenList[c].animate(a,b)}return this},
endAnimate:function(a,b){CAAT.ActorContainer.superclass.endAnimate.call(this,a,b);var c;for(c=this.childrenList.length-1;c>=0;c--){var d=this.childrenList[c];if(d.expired&&d.discardable){d.destroy(b);this.childrenList.splice(c,1)}else d.endAnimate(a,b)}},addChild:function(a){a.parent=this;this.childrenList.push(a);return this},findChild:function(a){var b=0;for(b=0;b<this.childrenList.length;b++)if(this.childrenList[b]==a)return b;return-1},removeChild:function(a){a=this.findChild(a);-1!=a&&this.childrenList.splice(a,
1);return this},findActorAtPosition:function(a){if(null==CAAT.ActorContainer.superclass.findActorAtPosition.call(this,a))return null;for(a=this.childrenList.length-1;a>=0;a--){var b=this.childrenList[a].findActorAtPosition(this.rpoint);if(null!=b)return b}return this},destroy:function(){for(var a=this.childrenList.length-1;a>=0;a--)this.childrenList[a].destroy();CAAT.ActorContainer.superclass.destroy.call(this);return this},getNumChildren:function(){return this.childrenList.length},getChildAt:function(a){return this.childrenList[a]}})})();
(function(){CAAT.SpriteActor=function(){CAAT.SpriteActor.superclass.constructor.call(this);return this};extend(CAAT.SpriteActor,CAAT.Actor,{compoundbitmap:null,animationImageIndex:null,prevAnimationTime:-1,changeFPS:1E3,transformation:0,spriteIndex:0,TR_NONE:0,TR_FLIP_HORIZONTAL:1,TR_FLIP_VERTICAL:2,TR_FLIP_ALL:3,setSpriteImage:function(a){this.compoundbitmap=a;this.width=a.singleWidth;this.height=a.singleHeight;null==this.animationImageIndex&&this.setAnimationImageIndex([0]);return this},setChangeFPS:function(a){this.changeFPS=
a;return this},setSpriteTransformation:function(a){this.transformation=a;return this},setAnimationImageIndex:function(a){this.animationImageIndex=a;this.spriteIndex=a[0];return this},animate:function(a,b){if(this.compoundbitmap&&this.animationImageIndex){if(this.animationImageIndex.length>1)if(this.prevAnimationTime==-1)this.prevAnimationTime=b;else{var c=b;c-=this.prevAnimationTime;c/=this.changeFPS;c%=this.animationImageIndex.length;this.spriteIndex=this.animationImageIndex[Math.floor(c)]}CAAT.SpriteActor.superclass.animate.call(this,
a,b)}},paint:function(a){a=a.crc;switch(this.transformation){case this.TR_FLIP_HORIZONTAL:this.compoundbitmap.paintInvertedH(a,this.spriteIndex,0,0);break;case this.TR_FLIP_VERTICAL:this.compoundbitmap.paintInvertedV(a,this.spriteIndex,0,0);break;case this.TR_FLIP_ALL:this.compoundbitmap.paintInvertedHV(a,this.spriteIndex,0,0);break;default:this.compoundbitmap.paint(a,this.spriteIndex,0,0)}}})})();
(function(){CAAT.TextActor=function(){CAAT.TextActor.superclass.constructor.call(this);this.font="10px sans-serif";this.textAlign="left";this.textBaseline="top";this.outlineColor="black";this.clip=false;return this};extend(CAAT.TextActor,CAAT.Actor,{font:null,textAlign:null,textBaseline:null,fill:true,text:null,textWidth:0,textHeight:0,outline:false,outlineColor:null,path:null,pathInterpolator:null,pathDuration:1E4,sign:1,setFill:function(a){this.fill=a;return this},setOutline:function(a){this.outline=
a;return this},setOutlineColor:function(a){this.outlineColor=a;return this},setText:function(a){this.text=a;this.setFont(this.font);return this},setAlign:function(a){this.textAlign=a;return this},setBaseline:function(a){this.textBaseline=a;return this},setFont:function(a){if(!a)return this;this.font=a;if(this.text==""||null==this.text)this.width=this.height=0;return this},calcTextSize:function(a){a.crc.save();a.crc.font=this.font;this.textWidth=a.crc.measureText(this.text).width;if(this.width==0)this.width=
this.textWidth;try{var b=this.font.substring(0,this.font.indexOf("px"));this.textHeight=parseInt(b)}catch(c){this.textHeight=20}if(this.height==0)this.height=this.textHeight;a.crc.restore();return this},paint:function(a,b){if(null!=this.text){if(this.textWidth==0||this.textHeight==0)this.calcTextSize(a);var c=a.crc;if(null!=this.font)c.font=this.font;if(null!=this.textAlign)c.textAlign=this.textAlign;if(null!=this.textBaseline)c.textBaseline=this.textBaseline;if(null!=this.fillStyle)c.fillStyle=this.fillStyle;
if(null==this.path){var d=0;if(this.textAlign=="center")d=this.width/2;else if(this.textAlign=="right")d=this.width;if(this.fill){c.fillText(this.text,d,0);if(this.outline){if(null!=this.outlineColor)c.strokeStyle=this.outlineColor;c.beginPath();c.strokeText(this.text,d,0)}}else{if(null!=this.outlineColor)c.strokeStyle=this.outlineColor;c.strokeText(this.text,d,0)}}else this.drawOnPath(a,b)}},drawOnPath:function(a,b){for(var c=a.crc,d=this.sign*this.pathInterpolator.getPosition(b%this.pathDuration/
this.pathDuration).y*this.path.getLength(),e=new CAAT.Point,f=new CAAT.Point,g=0;g<this.text.length;g++){var h=this.text[g].toString(),i=c.measureText(h).width;this.path.getLength();f=i/2+d;e=this.path.getPositionFromLength(f).clone();f=this.path.getPositionFromLength(f-0.1).clone();f=Math.atan2(e.y-f.y,e.x-f.x);c.save();c.translate(e.x,e.y);c.rotate(f);this.fill&&c.fillText(h,0,0);if(this.outline){c.strokeStyle=this.outlineColor;c.strokeText(h,0,0)}c.restore();d+=i}},setPath:function(a,b,c){this.path=
a;this.pathInterpolator=b||(new CAAT.Interpolator).createLinearInterpolator();this.pathDuration=c||1E4;this.setBounds(0,0,parent.width,parent.height);this.mouseEnabled=false;return this}})})();
(function(){CAAT.ShapeActor=function(){CAAT.ShapeActor.superclass.constructor.call(this);this.compositeOp="source-over";return this};extend(CAAT.ShapeActor,CAAT.Actor,{shape:0,compositeOp:null,SHAPE_CIRCLE:0,SHAPE_RECTANGLE:1,setShape:function(a){this.shape=a;return this},setCompositeOp:function(a){this.compositeOp=a;return this},paint:function(a,b){switch(this.shape){case 0:this.paintCircle(a,b);break;case 1:this.paintRectangle(a,b);break}},paintCircle:function(a){a=a.crc;a.globalCompositeOperation=
this.compositeOp;if(null!=this.fillStyle){a.fillStyle=this.fillStyle;a.beginPath();a.arc(this.width/2,this.height/2,Math.min(this.width,this.height)/2,0,2*Math.PI,false);a.fill()}if(null!=this.strokeStyle){a.strokeStyle=this.strokeStyle;a.beginPath();a.arc(this.width/2,this.height/2,Math.min(this.width,this.height)/2,0,2*Math.PI,false);a.stroke()}},paintRectangle:function(a){a=a.crc;a.globalCompositeOperation=this.compositeOp;if(null!=this.fillStyle){a.fillStyle=this.fillStyle;a.fillRect(0,0,this.width,
this.height);a.fill()}if(null!=this.strokeStyle){a.strokeStyle=this.strokeStyle;a.strokeRect(0,0,this.width,this.height);a.stroke()}}})})();(function(){CAAT.CompoundImage=function(){return this};CAAT.CompoundImage.prototype={NORMAL:1,INV_VERTICAL:2,INV_HORIZONTAL:4,INV_VERTICAL_AND_HORIZONTAL:8,image:null,rows:0,cols:0,width:0,height:0,singleWidth:0,singleHeight:0,initialize:function(a,b,c){this.image=a;this.rows=b;this.cols=c;this.width=a.width;this.height=a.height;this.singleWidth=Math.floor(this.width/c);this.singleHeight=Math.floor(this.height/b);return this},paintInvertedH:function(a,b,c,d){var e=Math.floor(b%this.cols)*this.singleWidth;
b=Math.floor(b/this.cols)*this.singleHeight;a.save();a.translate(c+this.singleWidth,d);a.scale(-1,1);try{a.drawImage(this.image,e,b,this.singleWidth,this.singleHeight,0,0,this.singleWidth,this.singleHeight)}catch(f){}a.restore()},paintInvertedV:function(a,b,c,d){var e=Math.floor(b%this.cols)*this.singleWidth;b=Math.floor(b/this.cols)*this.singleHeight;a.save();a.translate(c,d+this.singleHeight);a.scale(1,-1);try{a.drawImage(this.image,e,b,this.singleWidth,this.singleHeight,0,0,this.singleWidth,this.singleHeight)}catch(f){}a.restore()},
paintInvertedHV:function(a,b,c,d){var e=Math.floor(b%this.cols)*this.singleWidth;b=Math.floor(b/this.cols)*this.singleHeight;a.save();a.translate(c,d+this.singleHeight);a.scale(1,-1);a.translate(this.singleWidth,0);a.scale(-1,1);try{a.drawImage(this.image,e,b,this.singleWidth,this.singleHeight,0,0,this.singleWidth,this.singleHeight)}catch(f){}a.restore()},paint:function(a,b,c,d){var e=Math.floor(b%this.cols)*this.singleWidth;b=Math.floor(b/this.cols)*this.singleHeight;try{a.drawImage(this.image,e,
b,this.singleWidth,this.singleHeight,c,d,this.singleWidth,this.singleHeight)}catch(f){}},paintScaled:function(a,b,c,d,e,f){a.drawImage(this.image,Math.floor(b%this.cols)*this.singleWidth,Math.floor(b/this.cols)*this.singleHeight,this.singleWidth,this.singleHeight,c,d,e,f)},getNumImages:function(){return this.rows*this.cols}}})();(function(){CAAT.ImagePreloader=function(){this.images=[];return this};CAAT.ImagePreloader.prototype={images:null,notificationCallback:null,imageCounter:0,loadImages:function(a,b){var c=this;this.notificationCallback=b;this.images=[];for(var d=0;d<a.length;d++){this.images.push({id:a[d].id,image:new Image});this.images[d].image.onload=function(){c.imageCounter++;c.notificationCallback.call(this,c.imageCounter,c.images)};this.images[d].image.src=a[d].url}}}})();(function(){CAAT.Director=function(){CAAT.Director.superclass.constructor.call(this);this.scenes=[]};extend(CAAT.Director,CAAT.ActorContainer,{debug:false,scenes:null,currentScene:null,canvas:null,crc:null,ctx:null,time:0,timeline:0,imagesCache:null,initialize:function(a,b,c){c=c||document.createElement("canvas");c.width=a;c.height=b;this.setBounds(0,0,c.width,c.height);this.create();this.canvas=c;this.crc=this.ctx=c.getContext("2d");if(!CAAT.director){CAAT.director=[];__GlobalEnableEvents()}CAAT.director.push(this);
this.timeline=(new Date).getTime();return this},render:function(a){this.time+=a;this.crc.globalAlpha=1;this.crc.globalCompositeOperation="source-over";this.crc.clearRect(0,0,this.width,this.height);this.crc.setTransform(1,0,0,1,0,0);var b,c;for(b=0;b<this.childrenList.length;b++)if(this.childrenList[b].isInAnimationFrame(this.time)){c=this.childrenList[b].time-this.childrenList[b].start_time;this.childrenList[b].animate(this,c)}for(b=0;b<this.childrenList.length;b++)if(this.childrenList[b].isInAnimationFrame(this.time)){this.crc.save();
c=this.childrenList[b].time-this.childrenList[b].start_time;this.childrenList[b].paintActor(this,c);this.childrenList[b].time+=a;this.crc.restore();this.debug&&this.childrenList[b].drawScreenBoundingBox(this,c)}this.endAnimate()},addScene:function(a){a.setBounds(0,0,this.width,this.height);this.scenes.push(a);a.setEaseListener(this);null==this.currentScene&&this.setScene(0)},getNumScenes:function(){return this.scenes.length},easeInOut:function(a,b,c,d,e,f,g,h,i,j){if(a!=this.getCurrentSceneIndex()){a=
this.scenes[a];d=this.scenes[d];a.setExpired(false);d.setExpired(false);a.mouseEnabled=false;d.mouseEnabled=false;a.resetTransform();d.resetTransform();a.setLocation(0,0);d.setLocation(0,0);a.alpha=1;d.alpha=1;if(b==CAAT.Scene.prototype.EASE_ROTATION)a.easeRotationIn(g,h,c,i);else b==CAAT.Scene.prototype.EASE_SCALE?a.easeScaleIn(0,g,h,c,i):a.easeTranslationIn(g,h,c,i);if(e==CAAT.Scene.prototype.EASE_ROTATION)d.easeRotationOut(g,h,f,j);else e==CAAT.Scene.prototype.EASE_SCALE?d.easeScaleOut(0,g,h,f,
j):d.easeTranslationOut(g,h,f,j);this.childrenList=[];this.addChild(d);this.addChild(a)}},easeInOutRandom:function(a,b,c,d){var e=Math.random(),f=Math.random(),g;if(e<0.33){e=CAAT.Scene.prototype.EASE_ROTATION;g=(new CAAT.Interpolator).createExponentialInOutInterpolator(4)}else if(e<0.66){e=CAAT.Scene.prototype.EASE_SCALE;g=(new CAAT.Interpolator).createElasticOutInterpolator(1.1,0.4)}else{e=CAAT.Scene.prototype.EASE_TRANSLATE;g=(new CAAT.Interpolator).createBounceOutInterpolator()}var h;if(f<0.33){f=
CAAT.Scene.prototype.EASE_ROTATION;h=(new CAAT.Interpolator).createExponentialInOutInterpolator(4)}else if(f<0.66){f=CAAT.Scene.prototype.EASE_SCALE;h=(new CAAT.Interpolator).createExponentialOutInterpolator(4)}else{f=CAAT.Scene.prototype.EASE_TRANSLATE;h=(new CAAT.Interpolator).createBounceOutInterpolator()}this.easeInOut(a,e,Math.random()*8.99>>0,b,f,Math.random()*8.99>>0,c,d,g,h)},easeIn:function(a,b,c,d,e,f){a=this.scenes[a];if(b==CAAT.Scene.prototype.EASE_ROTATION)a.easeRotationIn(c,d,e,f);else b==
CAAT.Scene.prototype.EASE_SCALE?a.easeScaleIn(0,c,d,e,f):a.easeTranslationIn(c,d,e,f);this.childrenList=[];this.addChild(a);a.resetTransform();a.setLocation(0,0);a.alpha=1;a.mouseEnabled=false;a.setExpired(false)},setScene:function(a){a=this.scenes[a];this.childrenList=[];this.addChild(a);this.currentScene=a;a.setFrameTime(this.time,Number.MAX_VALUE)},switchToScene:function(a,b,c,d){var e=this.getSceneIndex(this.currentScene);d?this.easeInOutRandom(a,e,b,c):this.setScene(a)},switchToPrevScene:function(a,
b,c){var d=this.getSceneIndex(this.currentScene);this.getNumScenes()<=1||d==0||(c?this.easeInOutRandom(d-1,d,a,b):this.setScene(d-1))},switchToNextScene:function(a,b,c){var d=this.getSceneIndex(this.currentScene);this.getNumScenes()<=1||d==this.getNumScenes()-1||(c?this.easeInOutRandom(d+1,d,a,b):this.setScene(d+1))},mouseEnter:function(){},mouseExit:function(){},mouseMove:function(){},mouseDown:function(){},mouseUp:function(){},mouseDrag:function(){},easeEnd:function(a,b){if(b){this.currentScene=
a;this.currentScene.activated()}else a.setExpired(true);a.mouseEnabled=true;a.emptyBehaviorList()},getSceneIndex:function(a){for(var b in this.scenes)if(this.scenes[b]==a)return b>>0;return-1},getCurrentSceneIndex:function(){return this.getSceneIndex(this.currentScene)},getBrowserName:function(){return BrowserDetect.browser},getBrowserVersion:function(){return BrowserDetect.version},getOSName:function(){return BrowserDetect.OS},getImage:function(a){for(var b=0;b<this.imagesCache.length;b++)if(this.imagesCache[b].id==
a)return this.imagesCache[b].image},emptyScenes:function(){this.scenes=[]},loop:function(a){a=a||30;a=1E3/a;var b=this,c=function(){var d=(new Date).getTime();b.render(d-b.timeline);b.timeline=d};c();setInterval(c,a)}})})();(function(){CAAT.MouseEvent=function(){this.point=new CAAT.Point;this.screenPoint=new CAAT.Point;return this};CAAT.MouseEvent.prototype={screenPoint:null,point:null,modifiers:0,time:0,source:null,SHIFT:16,CONTROL:17,ALT:18,SHIFT_MASK:1,CONTROL_MASK:2,ALT_MASK:4,init:function(a,b,c,d,e){this.point.set(a,b);this.modifiers=c;this.source=d;this.screenPoint=e;return this},isAltDown:function(){return this.modifiers&this.ALT_MASK},isControlDown:function(){return this.modifiers&this.CONTROL_MASK},isShiftDown:function(){return this.modifiers&
this.SHIFT_MASK}}})();var __lastSelectedActor=null,__mousePoint=null,__screenMousePoint=null,__mouseDown=false,__modifiers=0,__dragging=false,__targetDirector=null;
function __getCanvasCoord(a,b){var c=0,d=0;if(!b)b=window.event;if(b.pageX||b.pageY){c=b.pageX;d=b.pageY}else if(b.clientX||b.clientY){c=b.clientX+document.body.scrollLeft+document.documentElement.scrollLeft;d=b.clientY+document.body.scrollTop+document.documentElement.scrollTop}var e,f,g;for(g=0;g<CAAT.director.length;g++){e=c;f=d;e-=CAAT.director[g].canvas.offsetLeft;f-=CAAT.director[g].canvas.offsetTop;if(CAAT.director[g].contains(e,f)){__targetDirector=CAAT.director[g];a.set(e,f);__screenMousePoint.set(e,
f);return}}__targetDirector=null}
function __GlobalEnableEvents(){__mousePoint=new CAAT.Point;__screenMousePoint=new CAAT.Point;window.addEventListener("keydown",function(a){switch(a.which?a.which:event.keyCode){case CAAT.MouseEvent.prototype.SHIFT:__modifiers|=CAAT.MouseEvent.prototype.SHIFT_MASK;break;case CAAT.MouseEvent.prototype.CONTROL:__modifiers|=CAAT.MouseEvent.prototype.CONTROL_MASK;break;case CAAT.MouseEvent.prototype.ALT:__modifiers|=CAAT.MouseEvent.prototype.ALT_MASK;break}},false);window.addEventListener("keyup",function(a){switch(a.which?
a.which:event.keyCode){case CAAT.MouseEvent.prototype.SHIFT:__modifiers&=~CAAT.MouseEvent.prototype.SHIFT_MASK;break;case CAAT.MouseEvent.prototype.CONTROL:__modifiers&=~CAAT.MouseEvent.prototype.CONTROL_MASK;break;case CAAT.MouseEvent.prototype.ALT:__modifiers&=~CAAT.MouseEvent.prototype.ALT_MASK;break;case 68:if(null!=__targetDirector)__targetDirector.debug=!__targetDirector.debug;break}},false);window.addEventListener("mouseup",function(){__mouseDown=false;null!=__lastSelectedActor&&__lastSelectedActor.mouseUp((new CAAT.MouseEvent).init(__lastSelectedActor.rpoint.x,
__lastSelectedActor.rpoint.y,__modifiers,__lastSelectedActor,__screenMousePoint));if(__dragging)__dragging=false;else null!=__lastSelectedActor&&__lastSelectedActor.mouseClick((new CAAT.MouseEvent).init(__lastSelectedActor.rpoint.x,__lastSelectedActor.rpoint.y,__modifiers,__lastSelectedActor,__screenMousePoint))},false);window.addEventListener("mousedown",function(){if(null!=__targetDirector){__mouseDown=true;__lastSelectedActor=__targetDirector.findActorAtPosition(__mousePoint);null!=__lastSelectedActor&&
__lastSelectedActor.mouseDown((new CAAT.MouseEvent).init(__lastSelectedActor.rpoint.x,__lastSelectedActor.rpoint.y,__modifiers,__lastSelectedActor,__screenMousePoint))}},false);window.addEventListener("mouseover",function(a){__getCanvasCoord(__mousePoint,a);if(null!=__targetDirector){__lastSelectedActor=__targetDirector.findActorAtPosition(__mousePoint);null!=__lastSelectedActor&&__lastSelectedActor.mouseEnter((new CAAT.MouseEvent).init(__lastSelectedActor.rpoint.x,__lastSelectedActor.rpoint.y,__modifiers,
__lastSelectedActor,__screenMousePoint))}},false);window.addEventListener("mouseout",function(){if(null!=__lastSelectedActor){__lastSelectedActor.mouseExit((new CAAT.MouseEvent).init(0,0,__modifiers,__lastSelectedActor,__screenMousePoint));__lastSelectedActor=null}__mouseDown=false},false);window.addEventListener("mousemove",function(a){__getCanvasCoord(__mousePoint,a);if(null!=__targetDirector)if(__mouseDown&&null!=__lastSelectedActor){__dragging=true;null!=__lastSelectedActor.parent&&__lastSelectedActor.parent.inverseTransformCoord(__mousePoint);
__lastSelectedActor.mouseDrag((new CAAT.MouseEvent).init(__mousePoint.x,__mousePoint.y,__modifiers,__lastSelectedActor,__screenMousePoint))}else{a=__targetDirector.findActorAtPosition(__mousePoint);if(a!=__lastSelectedActor){null!=__lastSelectedActor&&__lastSelectedActor.mouseExit((new CAAT.MouseEvent).init(__mousePoint.x,__mousePoint.y,__modifiers,__lastSelectedActor,__screenMousePoint));null!=a&&a.mouseEnter((new CAAT.MouseEvent).init(a.rpoint.x,a.rpoint.y,__modifiers,a,__screenMousePoint))}__lastSelectedActor=
a;null!=a&&__lastSelectedActor.mouseMove((new CAAT.MouseEvent).init(__lastSelectedActor.rpoint.x,__lastSelectedActor.rpoint.y,__modifiers,__lastSelectedActor,__screenMousePoint))}},false);window.addEventListener("dblclick",function(a){__getCanvasCoord(__mousePoint,a);null!=__lastSelectedActor&&__lastSelectedActor.mouseDblClick((new CAAT.MouseEvent).init(__lastSelectedActor.rpoint.x,__lastSelectedActor.rpoint.y,__modifiers,__lastSelectedActor,__screenMousePoint))},false)};(function(){CAAT.Scene=function(){CAAT.Scene.superclass.constructor.call(this);return this};extend(CAAT.Scene,CAAT.ActorContainer,{easeContainerBehaviour:null,easeContainerBehaviourListener:null,easeIn:false,EASE_ROTATION:1,EASE_SCALE:2,EASE_TRANSLATE:3,createAlphaBehaviour:function(a,b){var c=new CAAT.AlphaBehavior;c.setFrameTime(0,a);c.startAlpha=b?0:1;c.endAlpha=b?1:0;this.easeContainerBehaviour.addBehavior(c)},easeTranslationIn:function(a,b,c,d){this.easeTranslation(a,b,c,true,d)},easeTranslationOut:function(a,
b,c,d){this.easeTranslation(a,b,c,false,d)},easeTranslation:function(a,b,c,d,e){this.easeContainerBehaviour=new CAAT.ContainerBehavior;this.easeIn=d;var f=new CAAT.PathBehavior;e&&f.setInterpolator(e);f.setFrameTime(0,a);c%=4;c++;switch(c){case CAAT.Actor.prototype.ANCHOR_TOP:d?f.setPath((new CAAT.Path).setLinear(0,-this.height,0,0)):f.setPath((new CAAT.Path).setLinear(0,0,0,-this.height));break;case CAAT.Actor.prototype.ANCHOR_BOTTOM:d?f.setPath((new CAAT.Path).setLinear(0,this.height,0,0)):f.setPath((new CAAT.Path).setLinear(0,
0,0,this.height));break;case CAAT.Actor.prototype.ANCHOR_LEFT:d?f.setPath((new CAAT.Path).setLinear(-this.width,0,0,0)):f.setPath((new CAAT.Path).setLinear(0,0,-this.width,0));break;case CAAT.Actor.prototype.ANCHOR_RIGHT:d?f.setPath((new CAAT.Path).setLinear(this.width,0,0,0)):f.setPath((new CAAT.Path).setLinear(0,0,this.width,0));break}b&&this.createAlphaBehaviour(a,d);this.easeContainerBehaviour.addBehavior(f);this.easeContainerBehaviour.setFrameTime(this.time,a);this.easeContainerBehaviour.addListener(this);
this.emptyBehaviorList();CAAT.Scene.superclass.addBehavior.call(this,this.easeContainerBehaviour)},easeScaleIn:function(a,b,c,d,e){this.easeScale(a,b,c,d,true,e);this.easeIn=true},easeScaleOut:function(a,b,c,d,e){this.easeScale(a,b,c,d,false,e);this.easeIn=false},easeScale:function(a,b,c,d,e,f){this.easeContainerBehaviour=new CAAT.ContainerBehavior;var g=0,h=0,i=0,j=0;switch(d){case CAAT.Actor.prototype.ANCHOR_TOP_LEFT:case CAAT.Actor.prototype.ANCHOR_TOP_RIGHT:case CAAT.Actor.prototype.ANCHOR_BOTTOM_LEFT:case CAAT.Actor.prototype.ANCHOR_BOTTOM_RIGHT:case CAAT.Actor.prototype.ANCHOR_CENTER:j=
i=1;break;case CAAT.Actor.prototype.ANCHOR_TOP:case CAAT.Actor.prototype.ANCHOR_BOTTOM:i=g=1;h=0;j=1;break;case CAAT.Actor.prototype.ANCHOR_LEFT:case CAAT.Actor.prototype.ANCHOR_RIGHT:j=h=1;g=0;i=1;break;default:alert("scale anchor ?? "+d)}if(!e){var k;k=g;g=i;i=k;k=h;h=j;j=k}c&&this.createAlphaBehaviour(b,e);c=new CAAT.ScaleBehavior;c.setFrameTime(a,b);c.startScaleX=g;c.startScaleY=h;c.endScaleX=i;c.endScaleY=j;c.anchor=d;f&&c.setInterpolator(f);this.easeContainerBehaviour.addBehavior(c);this.easeContainerBehaviour.setFrameTime(this.time,
b);this.easeContainerBehaviour.addListener(this);this.emptyBehaviorList();CAAT.Scene.superclass.addBehavior.call(this,this.easeContainerBehaviour)},addBehavior:function(){},easeRotationIn:function(a,b,c,d){this.easeRotation(a,b,c,true,d);this.easeIn=true},easeRotationOut:function(a,b,c,d){this.easeRotation(a,b,c,false,d);this.easeIn=false},easeRotation:function(a,b,c,d,e){this.easeContainerBehaviour=new CAAT.ContainerBehavior;var f=0,g=0;switch(c){case CAAT.Actor.prototype.ANCHOR_CENTER:c=CAAT.Actor.prototype.ANCHOR_TOP;
case CAAT.Actor.prototype.ANCHOR_TOP:case CAAT.Actor.prototype.ANCHOR_BOTTOM:case CAAT.Actor.prototype.ANCHOR_LEFT:case CAAT.Actor.prototype.ANCHOR_RIGHT:f=Math.PI*(Math.random()<0.5?1:-1);break;case CAAT.Actor.prototype.ANCHOR_TOP_LEFT:case CAAT.Actor.prototype.ANCHOR_TOP_RIGHT:case CAAT.Actor.prototype.ANCHOR_BOTTOM_LEFT:case CAAT.Actor.prototype.ANCHOR_BOTTOM_RIGHT:f=Math.PI/2*(Math.random()<0.5?1:-1);break;default:alert("rot anchor ?? "+c)}if(false==d){var h=f;f=g;g=h}b&&this.createAlphaBehaviour(a,
d);b=new CAAT.RotateBehavior;b.setFrameTime(0,a);b.startAngle=f;b.endAngle=g;b.anchor=c;e&&b.setInterpolator(e);this.easeContainerBehaviour.addBehavior(b);this.easeContainerBehaviour.setFrameTime(this.time,a);this.easeContainerBehaviour.addListener(this);this.emptyBehaviorList();CAAT.Scene.superclass.addBehavior.call(this,this.easeContainerBehaviour)},setEaseListener:function(a){this.easeContainerBehaviourListener=a},behaviorExpired:function(){this.easeContainerBehaviourListener.easeEnd(this,this.easeIn)},
activated:function(){},setExpired:function(a){this.expired=a},paint:function(a){a=a.crc;a.fillStyle=this.fillStyle!=null?this.fillStyle:"white";a.fillRect(0,0,this.width,this.height)}})})();(function(){CAAT.Matrix=function(){this.matrix=[[1,0,0],[0,1,0],[0,0,1]];return this};CAAT.Matrix.prototype={matrix:null,type:false,TYPE_ROTATE:0,TYPE_SCALE:1,TYPE_TRANSLATE:2,transform:function(a){var b=a.x,c=a.y;if(this.type==this.TYPE_ROTATE){a.x=b*this.matrix[0][0]+c*this.matrix[1][0]+this.matrix[0][2];a.y=b*this.matrix[0][1]+c*this.matrix[1][1]+this.matrix[1][2]}else if(this.type==this.TYPE_SCALE){a.x*=this.matrix[0][0];a.y*=this.matrix[1][1]}else if(this.type==this.TYPE_TRANSLATE){a.x+=this.matrix[0][2];
a.y+=this.matrix[1][2]}else{a.x=b*this.matrix[0][0]+c*this.matrix[0][1]+this.matrix[0][2];a.y=b*this.matrix[1][0]+c*this.matrix[1][1]+this.matrix[1][2]}return a},rotate:function(a){var b=new CAAT.Matrix;b.matrix[0][0]=Math.cos(a);b.matrix[1][0]=-Math.sin(a);b.matrix[0][1]=Math.sin(a);b.matrix[1][1]=Math.cos(a);b.type=this.TYPE_ROTATE;return b},_rotateAnchor:function(a,b,c){var d=new CAAT.Matrix;d.matrix[0][0]=Math.cos(a);d.matrix[1][0]=-Math.sin(a);d.matrix[0][1]=Math.sin(a);d.matrix[1][1]=Math.cos(a);
d.matrix[0][2]=b;d.matrix[1][2]=c;d.type=this.TYPE_ROTATE;return d},scale:function(a,b){var c=new CAAT.Matrix;c.matrix[0][0]=a;c.matrix[1][1]=b;c.type=this.TYPE_SCALE;return c},translate:function(a,b){var c=new CAAT.Matrix;c.matrix[0][2]=a;c.matrix[1][2]=b;c.type=this.TYPE_TRANSLATE;return c},copy:function(a){this.matrix[0][0]=a[0][0];this.matrix[0][1]=a[0][1];this.matrix[0][2]=a[0][2];this.matrix[1][0]=a[1][0];this.matrix[1][1]=a[1][1];this.matrix[1][2]=a[1][2];this.matrix[2][0]=a[2][0];this.matrix[2][1]=
a[2][1];this.matrix[2][2]=a[2][2]},identity:function(){this.matrix[0][0]=1;this.matrix[0][1]=0;this.matrix[0][2]=0;this.matrix[1][0]=0;this.matrix[1][1]=1;this.matrix[1][2]=0;this.matrix[2][0]=0;this.matrix[2][1]=0;this.matrix[2][2]=1},multiply:function(a){var b=this.matrix[0][0]*a.matrix[0][1]+this.matrix[0][1]*a.matrix[1][1]+this.matrix[0][2]*a.matrix[2][1],c=this.matrix[0][0]*a.matrix[0][2]+this.matrix[0][1]*a.matrix[1][2]+this.matrix[0][2]*a.matrix[2][2],d=this.matrix[1][0]*a.matrix[0][0]+this.matrix[1][1]*
a.matrix[1][0]+this.matrix[1][2]*a.matrix[2][0],e=this.matrix[1][0]*a.matrix[0][1]+this.matrix[1][1]*a.matrix[1][1]+this.matrix[1][2]*a.matrix[2][1],f=this.matrix[1][0]*a.matrix[0][2]+this.matrix[1][1]*a.matrix[1][2]+this.matrix[1][2]*a.matrix[2][2],g=this.matrix[2][0]*a.matrix[0][0]+this.matrix[2][1]*a.matrix[1][0]+this.matrix[2][2]*a.matrix[2][0],h=this.matrix[2][0]*a.matrix[0][1]+this.matrix[2][1]*a.matrix[1][1]+this.matrix[2][2]*a.matrix[2][1],i=this.matrix[2][0]*a.matrix[0][2]+this.matrix[2][1]*
a.matrix[1][2]+this.matrix[2][2]*a.matrix[2][2];this.matrix[0][0]=this.matrix[0][0]*a.matrix[0][0]+this.matrix[0][1]*a.matrix[1][0]+this.matrix[0][2]*a.matrix[2][0];this.matrix[0][1]=b;this.matrix[0][2]=c;this.matrix[1][0]=d;this.matrix[1][1]=e;this.matrix[1][2]=f;this.matrix[2][0]=g;this.matrix[2][1]=h;this.matrix[2][2]=i},premultiply:function(a){var b=a.matrix[0][0]*this.matrix[0][1]+a.matrix[0][1]*this.matrix[1][1]+a.matrix[0][2]*this.matrix[2][1],c=a.matrix[0][0]*this.matrix[0][2]+a.matrix[0][1]*
this.matrix[1][2]+a.matrix[0][2]*this.matrix[2][2],d=a.matrix[1][0]*this.matrix[0][0]+a.matrix[1][1]*this.matrix[1][0]+a.matrix[1][2]*this.matrix[2][0],e=a.matrix[1][0]*this.matrix[0][1]+a.matrix[1][1]*this.matrix[1][1]+a.matrix[1][2]*this.matrix[2][1],f=a.matrix[1][0]*this.matrix[0][2]+a.matrix[1][1]*this.matrix[1][2]+a.matrix[1][2]*this.matrix[2][2],g=a.matrix[2][0]*this.matrix[0][0]+a.matrix[2][1]*this.matrix[1][0]+a.matrix[2][2]*this.matrix[2][0],h=a.matrix[2][0]*this.matrix[0][1]+a.matrix[2][1]*
this.matrix[1][1]+a.matrix[2][2]*this.matrix[2][1],i=a.matrix[2][0]*this.matrix[0][2]+a.matrix[2][1]*this.matrix[1][2]+a.matrix[2][2]*this.matrix[2][2];this.matrix[0][0]=a.matrix[0][0]*this.matrix[0][0]+a.matrix[0][1]*this.matrix[1][0]+a.matrix[0][2]*this.matrix[2][0];this.matrix[0][1]=b;this.matrix[0][2]=c;this.matrix[1][0]=d;this.matrix[1][1]=e;this.matrix[1][2]=f;this.matrix[2][0]=g;this.matrix[2][1]=h;this.matrix[2][2]=i},getInverse:function(){var a=this.matrix[0][2],b=this.matrix[1][2],c=this.matrix[0][0],
d=this.matrix[0][1],e=this.matrix[1][0],f=this.matrix[1][1],g=new CAAT.Matrix;if(this.type==this.TYPE_ROTATE){g.matrix[0][0]=c;g.matrix[0][1]=e;g.matrix[1][0]=d;g.matrix[1][1]=f}else if(this.type==this.TYPE_SCALE){g.matrix[0][0]=1/c;g.matrix[1][1]=1/f}else if(this.type==this.TYPE_TRANSLATE){g.matrix[0][2]=-a;g.matrix[1][2]=-b}g.type=this.type;return g}}})();
(function(){CAAT.MatrixStack=function(){this.matrix=new CAAT.Matrix;this.stack=[];this.saved=[];return this};CAAT.MatrixStack.prototype={matrix:null,stack:null,saved:null,pushMatrix:function(a){this.stack.push(a)},popMatrix:function(){return this.stack.pop()},save:function(){this.saved.push(this.stack.length)},restore:function(){for(var a=this.saved.pop();this.stack.length!=a;)this.popMatrix()},transform:function(a){for(var b=0;b<this.stack.length;b++){var c=this.stack[b].matrix;a.transform(c[0][0],
c[0][1],c[1][0],c[1][1],c[0][2],c[1][2])}},transformInverse:function(a){for(var b=this.stack.length-1;b>=0;b--){var c=this.stack[b].getInverse();a.transform(c.matrix[0][0],c.matrix[0][1],c.matrix[1][0],c.matrix[1][1],c.matrix[0][2],c.matrix[1][2])}},prepareGraphics:function(a,b){this.stack=[];this.pushMatrix(CAAT.Matrix.prototype.translate(b.x,b.y));if(b.rotationAngle!=0){this.pushMatrix(CAAT.Matrix.prototype.translate(b.rotationX,b.rotationY));this.pushMatrix(CAAT.Matrix.prototype.rotate(b.rotationAngle));
this.pushMatrix(CAAT.Matrix.prototype.translate(-b.rotationX,-b.rotationY))}if(b.scaleX!=1||b.scaleY!=1)if(b.scaleX!=0&&b.scaleY!=0){this.pushMatrix(CAAT.Matrix.prototype.translate(b.scaleTX-b.width,b.scaleTY-b.height));this.pushMatrix(CAAT.Matrix.prototype.scale(b.scaleX,b.scaleY));this.pushMatrix(CAAT.Matrix.prototype.translate(-(b.scaleTX-b.width/b.scaleX),-(b.scaleTY-b.height/b.scaleY)))}else this.pushMatrix(CAAT.Matrix.prototype.scale(0,0));this.transform(a)},transformCoord:function(a){for(var b=
this.stack.length-1;b>=0;b--)this.stack[b].transform(a);return a},transformCoordNoTranslate:function(a){for(var b=this.stack.length-1;b>=1;b--)this.stack[b].transform(a);return a},inverseTransformCoord:function(a){for(var b=0;b<this.stack.length;b++)this.stack[b].getInverse().transform(a);return a}}})();(function(){CAAT.Point=function(){return this};CAAT.Point.prototype={x:0,y:0,set:function(a,b){this.x=a;this.y=b;return this},clone:function(){var a=new CAAT.Point;a.set(this.x,this.y);return a},translate:function(a,b){this.x+=a;this.y+=b;return this}}})();(function(){CAAT.Rectangle=function(){return this};CAAT.Rectangle.prototype={x:0,y:0,x1:0,y1:0,width:0,height:0,contains:function(a,b){return a>=0&&a<this.width&&b>=0&&b<this.height},isEmpty:function(){return this.width==0&&this.height==0},union:function(a,b){if(this.isEmpty()&&this.x==0&&this.y==0){this.x=a;this.y=b}else{this.x1=this.x+this.width;this.y1=this.y+this.height;if(b<this.y)this.y=b;if(a<this.x)this.x=a;if(b>this.y1)this.y1=b;if(a>this.x1)this.x1=a;this.width=this.x1-this.x;this.height=
this.y1-this.y}}}})();(function(){CAAT.Curve=function(){return this};CAAT.Curve.prototype={coordlist:null,k:0.05,length:-1,interpolator:false,HANDLE_SIZE:20,drawHandles:true,paint:function(a){a=a.crc;a.save();a.beginPath();a.strokeStyle="#a0a0a0";a.moveTo(this.coordlist[0].x,this.coordlist[0].y);a.lineTo(this.coordlist[1].x,this.coordlist[1].y);a.stroke();if(this.cubic){a.moveTo(this.coordlist[2].x,this.coordlist[2].y);a.lineTo(this.coordlist[3].x,this.coordlist[3].y);a.stroke()}if(this.drawHandles){a.globalAlpha=0.5;
for(var b=0;b<this.coordlist.length;b++){a.fillStyle="#7f7f00";a.beginPath();a.arc(this.coordlist[b].x,this.coordlist[b].y,this.HANDLE_SIZE/2,0,2*Math.PI,false);a.fill()}}a.restore()},update:function(){this.calcLength()},solve:function(){},getBoundingBox:function(a){a||(a=new CAAT.Rectangle);for(var b=new CAAT.Point,c=this.k;c<=1+this.k;c+=this.k){this.solve(b);a.union(b.x,b.y)}return a},calcLength:function(){var a,b;a=this.coordlist[0].x;b=this.coordlist[0].y;for(var c=0,d=new CAAT.Point,e=this.k;e<=
1+this.k;e+=this.k){this.solve(d,e);c+=Math.sqrt((d.x-a)*(d.x-a)+(d.y-b)*(d.y-b));a=d.x;b=d.y}return this.length=c},getLength:function(){return this.length},endCurvePosition:function(){return this.coordlist[this.coordlist.length-1]},startCurvePosition:function(){return this.coordlist[0]}}})();
(function(){CAAT.Bezier=function(){CAAT.Bezier.superclass.constructor.call(this);return this};extend(CAAT.Bezier,CAAT.Curve,{cubic:false,setCubic:function(a,b,c,d,e,f,g,h){this.coordlist=[];this.coordlist.push((new CAAT.Point).set(a,b));this.coordlist.push((new CAAT.Point).set(c,d));this.coordlist.push((new CAAT.Point).set(e,f));this.coordlist.push((new CAAT.Point).set(g,h));this.cubic=true;this.update()},setQuadric:function(a,b,c,d,e,f){this.coordlist=[];this.coordlist.push((new CAAT.Point).set(a,
b));this.coordlist.push((new CAAT.Point).set(c,d));this.coordlist.push((new CAAT.Point).set(e,f));this.cubic=false;this.update()},paint:function(a){this.cubic?this.paintCubic(a):this.paintCuadric(a);CAAT.Bezier.superclass.paint.call(this,a)},paintCuadric:function(a){var b,c;b=this.coordlist[0].x;c=this.coordlist[0].y;a=a.crc;a.save();a.beginPath();a.moveTo(b,c);b=new CAAT.Point;for(c=this.k;c<=1+this.k;c+=this.k){this.solve(b,c);a.lineTo(b.x,b.y)}a.stroke();a.restore()},paintCubic:function(a){var b,
c;b=this.coordlist[0].x;c=this.coordlist[0].y;a=a.crc;a.save();a.beginPath();a.moveTo(b,c);b=new CAAT.Point;for(c=this.k;c<=1+this.k;c+=this.k){this.solve(b,c);a.lineTo(b.x,b.y)}a.stroke();a.restore()},solve:function(a,b){return this.cubic?this.solveCubic(a,b):this.solveQuadric(a,b)},solveCubic:function(a,b){var c=b*b,d=b*c;a.x=this.coordlist[0].x+b*(-this.coordlist[0].x*3+b*(3*this.coordlist[0].x-this.coordlist[0].x*b))+b*(3*this.coordlist[1].x+b*(-6*this.coordlist[1].x+this.coordlist[1].x*3*b))+
c*(this.coordlist[2].x*3-this.coordlist[2].x*3*b)+this.coordlist[3].x*d;a.y=this.coordlist[0].y+b*(-this.coordlist[0].y*3+b*(3*this.coordlist[0].y-this.coordlist[0].y*b))+b*(3*this.coordlist[1].y+b*(-6*this.coordlist[1].y+this.coordlist[1].y*3*b))+c*(this.coordlist[2].y*3-this.coordlist[2].y*3*b)+this.coordlist[3].y*d;return a},solveQuadric:function(a,b){a.x=(1-b)*(1-b)*this.coordlist[0].x+2*(1-b)*b*this.coordlist[1].x+b*b*this.coordlist[2].x;a.y=(1-b)*(1-b)*this.coordlist[0].y+2*(1-b)*b*this.coordlist[1].y+
b*b*this.coordlist[2].y;return a}})})();
(function(){CAAT.CatmullRom=function(){CAAT.CatmullRom.superclass.constructor.call(this);return this};extend(CAAT.CatmullRom,CAAT.Curve,{setCurve:function(a,b,c,d,e,f,g,h){this.coordlist=[];this.coordlist.push((new CAAT.Point).set(a,b));this.coordlist.push((new CAAT.Point).set(c,d));this.coordlist.push((new CAAT.Point).set(e,f));this.coordlist.push((new CAAT.Point).set(g,h));this.cubic=true;this.update()},paint:function(a){var b,c;b=this.coordlist[0].x;c=this.coordlist[0].y;var d=a.crc;d.save();d.beginPath();
d.moveTo(b,c);b=new CAAT.Point;for(c=this.k;c<=1+this.k;c+=this.k){this.solve(b,c);d.lineTo(b.x,b.y)}d.stroke();d.restore();CAAT.CatmullRom.superclass.paint.call(this,a)},solve:function(a,b){var c=b*b,d=b*c,e=this.coordlist;a.x=0.5*(2*e[1].x+(-e[0].x+e[2].x)*b+(2*e[0].x-5*e[1].x+4*e[2].x-e[3].x)*c+(-e[0].x+3*e[1].x-3*e[2].x+e[3].x)*d);a.y=0.5*(2*e[1].y+(-e[0].y+e[2].y)*b+(2*e[0].y-5*e[1].y+4*e[2].y-e[3].y)*c+(-e[0].y+3*e[1].y-3*e[2].y+e[3].y)*d);return a}})})();(function(){CAAT.PathSegment=function(){return this};CAAT.PathSegment.prototype={endCurvePosition:function(){},startCurvePosition:function(){},getPosition:function(){},getLength:function(){},getBoundingBox:function(){},numControlPoints:function(){},getControlPoint:function(){},endPath:function(){},getContour:function(){}}})();
(function(){CAAT.LinearPath=function(){this.initialPosition=new CAAT.Point;this.finalPosition=new CAAT.Point;this.newPosition=new CAAT.Point;this.pathListener=[];return this};extend(CAAT.LinearPath,CAAT.PathSegment,{initialPosition:null,finalPosition:null,newPosition:null,setInitialPosition:function(a,b){this.initialPosition.x=a;this.initialPosition.y=b;this.newPosition.set(a,b);return this},setFinalPosition:function(a,b){this.finalPosition.x=a;this.finalPosition.y=b;return this},endCurvePosition:function(){return this.finalPosition},
startCurvePosition:function(){return this.initialPosition},getPosition:function(a){if(a>1||a<0)a%=1;if(a<0)a=1+a;this.newPosition.set(this.initialPosition.x+(this.finalPosition.x-this.initialPosition.x)*a,this.initialPosition.y+(this.finalPosition.y-this.initialPosition.y)*a);return this.newPosition},getLength:function(){var a=this.finalPosition.x-this.initialPosition.x,b=this.finalPosition.y-this.initialPosition.y;return Math.sqrt(a*a+b*b)},initialPositionX:function(){return this.initialPosition.x},
finalPositionX:function(){return this.finalPosition.x},paint:function(a){a=a.crc;a.beginPath();a.moveTo(this.initialPosition.x,this.initialPosition.y);a.lineTo(this.finalPosition.x,this.finalPosition.y);a.stroke();a.fillStyle="black";a.fillRect(this.initialPosition.x-3,this.initialPosition.y-3,6,6);a.fillRect(this.finalPosition.x-3,this.finalPosition.y-3,6,6)},getBoundingBox:function(a){a.union(this.initialPosition.x,this.initialPosition.y);a.union(this.finalPosition.x,this.finalPosition.y);return a},
numControlPoints:function(){return 2},getControlPoint:function(a){if(0==a)return this.initialPosition;else if(1==a)return this.finalPosition},getContour:function(){var a=[];a.push(this.getPosition(0).clone());a.push(this.getPosition(1).clone());return a}})})();
(function(){CAAT.CurvePath=function(){this.pathListener=[];this.newPosition=new CAAT.Point;return this};extend(CAAT.CurvePath,CAAT.PathSegment,{curve:null,newPosition:null,expired:false,setQuadric:function(a,b,c,d,e,f){var g=new CAAT.Bezier;g.setQuadric(a,b,c,d,e,f);this.curve=g;return this},setCubic:function(a,b,c,d,e,f,g,h){var i=new CAAT.Bezier;i.setCubic(a,b,c,d,e,f,g,h);this.curve=i;return this},updatePath:function(){this.curve.update()},getPosition:function(a){if(a>1||a<0)a%=1;if(a<0)a=1+a;
this.curve.solve(this.newPosition,a);return this.newPosition},getPositionFromLength:function(a){this.curve.solve(this.newPosition,a/this.getLength());return this.newPosition},initialPositionX:function(){return this.curve.coordlist[0].x},finalPositionX:function(){return this.curve.coordlist[this.curve.coordlist.length-1].x},getLength:function(){return this.curve.getLength()},paint:function(a){this.curve.paint(a)},getBoundingBox:function(a){this.curve.getBoundingBox(a);return a},numControlPoints:function(){return this.curve.coordlist.length},
getControlPoint:function(a){return this.curve.coordlist[a]},endCurvePosition:function(){return this.curve.endCurvePosition()},startCurvePosition:function(){return this.curve.startCurvePosition()},getContour:function(a){for(var b=[],c=0;c<=a;c++)b.push({x:c/a,y:this.getPosition(c/a).y});return b}})})();
(function(){CAAT.Path=function(){this.newPosition=new CAAT.Point;this.pathSegments=[];this.pathListener=[];return this};extend(CAAT.Path,CAAT.PathSegment,{pathSegments:null,pathSegmentDurationTime:null,pathSegmentStartTime:null,newPosition:null,pathLength:-1,beginPathX:-1,beginPathY:-1,trackPathX:-1,trackPathY:-1,endCurvePosition:function(){return this.pathSegments[this.pathSegments.length-1].endCurvePosition()},startCurvePosition:function(){return this.pathSegments[0].startCurvePosition()},setLinear:function(a,
b,c,d){this.beginPath(a,b);this.addLineTo(c,d);this.endPath();return this},setQuadric:function(a,b,c,d,e,f){this.beginPath(a,b);this.addQuadricTo(c,d,e,f);this.endPath();return this},setCubic:function(a,b,c,d,e,f,g,h){this.beginPath(a,b);this.addCubicTo(c,d,e,f,g,h);this.endPath();return this},addSegment:function(a){this.pathSegments.push(a);return this},addQuadricTo:function(a,b,c,d){var e=new CAAT.Bezier;e.setQuadric(this.trackPathX,this.trackPathY,a,b,c,d);this.trackPathX=c;this.trackPathY=d;a=
new CAAT.CurvePath;a.curve=e;this.pathSegments.push(a);return this},addCubicTo:function(a,b,c,d,e,f){var g=new CAAT.Bezier;g.setCubic(this.trackPathX,this.trackPathY,a,b,c,d,e,f);this.trackPathX=e;this.trackPathY=f;a=new CAAT.CurvePath;a.curve=g;this.pathSegments.push(a);return this},addCatmullTo:function(a,b,c,d,e,f){var g=new CAAT.CatmullRom;g.setCurve(this.trackPathX,this.trackPathY,a,b,c,d,e,f);this.trackPathX=e;this.trackPathY=f;a=new CAAT.CurvePath;a.curve=g;this.pathSegments.push(a);return this},
addLineTo:function(a,b){var c=new CAAT.LinearPath;c.setInitialPosition(this.trackPathX,this.trackPathY);c.setFinalPosition(a,b);this.trackPathX=a;this.trackPathY=b;this.pathSegments.push(c);return this},beginPath:function(a,b){this.trackPathX=a;this.trackPathY=b;this.beginPathX=a;this.beginPathY=b;return this},closePath:function(){this.addLineTo(this.beginPathX,this.beginPathY);this.trackPathX=this.beginPathX;this.trackPathY=this.beginPathY;this.endPath();return this},endPath:function(){this.pathSegmentStartTime=
[];this.pathSegmentDurationTime=[];this.pathLength=0;var a;for(a=0;a<this.pathSegments.length;a++){this.pathLength+=this.pathSegments[a].getLength();this.pathSegmentStartTime.push(0);this.pathSegmentDurationTime.push(0)}for(a=0;a<this.pathSegments.length;a++){this.pathSegmentDurationTime[a]=this.pathSegments[a].getLength()/this.pathLength;if(a>0)this.pathSegmentStartTime[a]=this.pathSegmentStartTime[a-1]+this.pathSegmentDurationTime[a-1];else this.pathSegmentStartTime[0]=0;this.pathSegments[a].endPath()}return this},
getLength:function(){return this.pathLength},getPosition:function(a){if(a>1||a<0)a%=1;if(a<0)a=1+a;for(var b=0;b<this.pathSegments.length;b++)if(this.pathSegmentStartTime[b]<=a&&a<=this.pathSegmentStartTime[b]+this.pathSegmentDurationTime[b]){a=(a-this.pathSegmentStartTime[b])/this.pathSegmentDurationTime[b];a=this.pathSegments[b].getPosition(a);this.newPosition.x=a.x;this.newPosition.y=a.y;break}return this.newPosition},getPositionFromLength:function(a){a%=this.getLength();if(a<0)a+=this.getLength();
for(var b=0,c=0;c<this.pathSegments.length;c++){if(b<=a&&a<=this.pathSegments[c].getLength()+b){a-=b;a=this.pathSegments[c].getPositionFromLength(a);this.newPosition.x=a.x;this.newPosition.y=a.y;break}b+=this.pathSegments[c].getLength()}return this.newPosition},paint:function(a){for(var b=0;b<this.pathSegments.length;b++)this.pathSegments[b].paint(a)},addPathListener:function(a){this.pathListener.push(a);return this},firePathFinishedEvent:function(a){for(var b=0;b<this.pathListener.length;b++)this.pathListener[b](this,
a)},getBoundingBox:function(a){if(null==a)a=new CAAT.Rectangle;for(var b=0;b<this.pathSegments.length;b++)this.pathSegments[b].getBoundingBox(a);return a},release:function(){this.ay=this.ax=-1},getNumSegments:function(){return this.pathSegments.length},getSegment:function(a){return this.pathSegments[a]},updatePath:function(){for(var a=0;a<this.pathSegments.length;a++)this.pathSegments[a].updatePath();this.endPath()},press:function(a,b){for(var c=CAAT.Curve.prototype.HANDLE_SIZE/2,d=0;d<this.pathSegments.length;d++)for(var e=
0;e<this.pathSegments[d].numControlPoints();e++){var f=this.pathSegments[d].getControlPoint(e);if(a>=f.x-c&&b>=f.y-c&&a<f.x+c&&b<f.y+c){this.point=[];this.point.push(f);if(e==0){c=d-1;if(c<0)c=this.pathSegments.length-1;this.point.push(this.pathSegments[c].endCurvePosition())}else e==this.pathSegments[d].numControlPoints()-1&&this.point.push(this.pathSegments[(d+1)%this.pathSegments.length].startCurvePosition());return}}this.point=null},drag:function(a,b){if(null!=this.point){if(-1==this.ax||-1==
this.ay){this.ax=a;this.ay=b}for(var c=0;c<this.point.length;c++){this.point[c].x+=a-this.ax;this.point[c].y+=b-this.ay}this.ax=a;this.ay=b;this.updatePath()}},ax:-1,ay:-1,point:[],getContour:function(a){for(var b=[],c=0;c<=a;c++)b.push({x:c/a,y:this.getPosition(c/a).y});return b}})})();(function(){CAAT.PathActor=function(){CAAT.PathActor.superclass.constructor.call(this);return this};extend(CAAT.PathActor,CAAT.Actor,{path:null,pathBoundingRectangle:null,bOutline:false,setPath:function(a){this.path=a;this.pathBoundingRectangle=a.getBoundingBox();return this},paint:function(a){var b=a.crc;b.strokeStyle="black";this.path.paint(a);if(this.bOutline){b.strokeStyle="black";b.strokeRect(0,0,this.width,this.height)}},mouseDrag:function(a){this.path.drag(a.point.x,a.point.y)},mouseDown:function(a){this.path.press(a.point.x,
a.point.y)},mouseUp:function(){this.path.release()}})})();(function(){CAAT.Behavior=function(){this.lifecycleListenerList=[];this.setDefaultInterpolator();return this};CAAT.Behavior.prototype={lifecycleListenerList:null,behaviorStartTime:-1,behaviorDuration:-1,cycleBehavior:false,expired:true,interpolator:null,actor:null,setDefaultInterpolator:function(){this.interpolator=(new CAAT.Interpolator).createLinearInterpolator(false);return this},setPingPong:function(){this.interpolator=(new CAAT.Interpolator).createLinearInterpolator(true);return this},setFrameTime:function(a,
b){this.behaviorStartTime=a;this.behaviorDuration=b;this.expired=false;return this},setInterpolator:function(a){this.interpolator=a;return this},apply:function(){},setCycle:function(a){this.cycleBehavior=a;return this},addListener:function(a){this.lifecycleListenerList.push(a);return this},getStartTime:function(){return this.behaviorStartTime},getDuration:function(){return this.behaviorDuration},isBehaviorInTime:function(a,b){if(this.expired)return false;if(this.cycleBehavior)if(a>this.behaviorStartTime)a=
(a-this.behaviorStartTime)%this.behaviorDuration+this.behaviorStartTime;if(a>this.behaviorStartTime+this.behaviorDuration){this.expired||this.setExpired(b,a);return false}return this.behaviorStartTime<=a&&a<this.behaviorStartTime+this.behaviorDuration},fireBehaviorExpiredEvent:function(a,b){for(var c=0;c<this.lifecycleListenerList.length;c++)this.lifecycleListenerList[c].behaviorExpired(this,b,a)},normalizeTime:function(a){a-=this.behaviorStartTime;if(this.cycleBehavior)a%=this.behaviorDuration;return this.interpolator.getPosition(a/
this.behaviorDuration).y},setExpired:function(a,b){this.expired=true;this.setForTime(this.interpolator.getPosition(1).y,a);this.fireBehaviorExpiredEvent(a,b)},setForTime:function(){},initialize:function(a){if(a)for(var b in a)this[b]=a[b];return this}}})();
(function(){CAAT.ContainerBehavior=function(){CAAT.ContainerBehavior.superclass.constructor.call(this);this.behaviors=[];return this};extend(CAAT.ContainerBehavior,CAAT.Behavior,{behaviors:null,addBehavior:function(a){this.behaviors.push(a);a.addListener(this)},apply:function(a,b){if(this.isBehaviorInTime(a,b)){a-=this.getStartTime();if(this.cycleBehavior)a%=this.getDuration();for(var c=0;c<this.behaviors.length;c++)this.behaviors[c].apply(a,b)}},setInterpolator:function(){},behaviorExpired:function(a,
b,c){if(this.cycleBehavior)a.expired=false;else this.fireBehaviorExpiredEvent(c,b)},setForTime:function(a,b){for(var c=0;c<this.behaviors.length;c++)this.behaviors[c].setForTime(a,b)}})})();
(function(){CAAT.RotateBehavior=function(){CAAT.RotateBehavior.superclass.constructor.call(this);this.anchor=CAAT.Actor.prototype.ANCHOR_CENTER;return this};extend(CAAT.RotateBehavior,CAAT.Behavior,{startAngle:0,endAngle:0,anchor:0,apply:function(a,b){if(this.isBehaviorInTime(a,b)){a=this.normalizeTime(a);this.setForTime(a,b)}},setForTime:function(a,b){var c=this.startAngle+a*(this.endAngle-this.startAngle),d=b.getAnchor(this.anchor);b.setRotationAnchored(c,d.x,d.y)},setAngles:function(a,b){this.startAngle=
a;this.endAngle=b;return this},setAnchor:function(a){this.anchor=a;return this}})})();
(function(){CAAT.ScaleBehavior=function(){CAAT.RotateBehavior.superclass.constructor.call(this);this.anchor=CAAT.Actor.prototype.ANCHOR_CENTER;return this};extend(CAAT.ScaleBehavior,CAAT.Behavior,{startScaleX:0,endScaleX:0,startScaleY:0,endScaleY:0,anchor:0,apply:function(a,b){if(this.isBehaviorInTime(a,b)){a=this.normalizeTime(a);this.setForTime(a,b)}},setForTime:function(a,b){var c=this.startScaleX+a*(this.endScaleX-this.startScaleX),d=this.startScaleY+a*(this.endScaleY-this.startScaleY);if(0==
c)c=0.01;if(0==d)d=0.01;b.setScaleAnchored(c,d,this.anchor)},setValues:function(a,b,c,d){this.startScaleX=a;this.endScaleX=b;this.startScaleY=c;this.endScaleY=d;return this},setAnchor:function(a){this.anchor=a;return this}})})();
(function(){CAAT.AlphaBehavior=function(){CAAT.AlphaBehavior.superclass.constructor.call(this);return this};extend(CAAT.AlphaBehavior,CAAT.Behavior,{startAlpha:0,endAlpha:0,apply:function(a,b){if(this.isBehaviorInTime(a,b)){a=this.normalizeTime(a);this.setForTime(a,b)}},setForTime:function(a,b){b.setAlpha(this.startAlpha+a*(this.endAlpha-this.startAlpha))},setValues:function(a,b){this.startAlpha=a;this.endAlpha=b;return this}})})();
(function(){CAAT.PathBehavior=function(){CAAT.PathBehavior.superclass.constructor.call(this);return this};extend(CAAT.PathBehavior,CAAT.Behavior,{path:null,autoRotate:false,prevX:-1,prevY:-1,translateX:0,translateY:0,setPath:function(a){this.path=a;return this},setFrameTime:function(a,b){CAAT.PathBehavior.superclass.setFrameTime.call(this,a,b);this.prevY=this.prevX=-1;return this},apply:function(a,b){if(this.isBehaviorInTime(a,b)){a=this.normalizeTime(a);this.setForTime(a,b)}},setForTime:function(a,
b){var c=this.path.getPosition(a);if(this.autoRotate){if(-1==this.prevX&&-1==this.prevY){this.prevX=c.x;this.prevY=c.y}var d=c.x-this.prevX,e=c.y-this.prevY;if(d==0&&e==0)return;d=Math.atan2(e,d);if(this.prevX<=c.x)b.transformation=CAAT.SpriteActor.prototype.TR_NONE;else{b.transformation=CAAT.SpriteActor.prototype.TR_FLIP_HORIZONTAL;d+=Math.PI}b.setRotation(d);this.prevX=c.x;this.prevY=c.y}b.setLocation(c.x-this.translateX,c.y-this.translateY)},positionOnTime:function(a){if(this.isBehaviorInTime(a,
null)){a=this.normalizeTime(a);return this.path.getPosition(a)}return{x:-1,y:-1}}})})();(function(){CAAT.Interpolator=function(){this.interpolated=new CAAT.Point;return this};CAAT.Interpolator.prototype={interpolated:null,paintScale:90,createLinearInterpolator:function(a,b){this.getPosition=function(c){var d=c;if(a)if(c<0.5)c*=2;else c=1-(c-0.5)*2;if(b!=null&&b)c=1-c;return this.interpolated.set(d,c)};return this},createExponentialInInterpolator:function(a,b){this.getPosition=function(c){var d=c;if(b)if(c<0.5)c*=2;else c=1-(c-0.5)*2;return this.interpolated.set(d,Math.pow(c,a))};return this},
createExponentialOutInterpolator:function(a,b){this.getPosition=function(c){var d=c;if(b)if(c<0.5)c*=2;else c=1-(c-0.5)*2;return this.interpolated.set(d,1-Math.pow(1-c,a))};return this},createExponentialInOutInterpolator:function(a,b){this.getPosition=function(c){var d=c;if(b)if(c<0.5)c*=2;else c=1-(c-0.5)*2;if(c*2<1)return this.interpolated.set(d,Math.pow(c*2,a)/2);return this.interpolated.set(d,1-Math.abs(Math.pow(c*2-2,a))/2)};return this},createQuadricBezierInterpolator:function(a,b,c,d){this.getPosition=
function(e){var f=e;if(d)if(e<0.5)e*=2;else e=1-(e-0.5)*2;e=(1-e)*(1-e)*a.y+2*(1-e)*e*b.y+e*e*c.y;return this.interpolated.set(f,e)};return this},createQubicBezierInterpolator:function(a,b,c,d,e){this.getPosition=function(f){var g=f;if(e)if(f<0.5)f*=2;else f=1-(f-0.5)*2;var h=f*f;f=a.y+f*(-a.y*3+f*(3*a.y-a.y*f))+f*(3*b.y+f*(-6*b.y+b.y*3*f))+h*(c.y*3-c.y*3*f)+d.y*f*h;return this.interpolated.set(g,f)};return this},createElasticOutInterpolator:function(a,b,c){this.getPosition=function(d){if(c)if(d<
0.5)d*=2;else d=1-(d-0.5)*2;if(d==0)return{x:0,y:0};if(d==1)return{x:1,y:1};var e=b/(2*Math.PI)*Math.asin(1/a);return this.interpolated.set(d,a*Math.pow(2,-10*d)*Math.sin((d-e)*2*Math.PI/b)+1)};return this},createElasticInInterpolator:function(a,b,c){this.getPosition=function(d){if(c)if(d<0.5)d*=2;else d=1-(d-0.5)*2;if(d==0)return{x:0,y:0};if(d==1)return{x:1,y:1};var e=b/(2*Math.PI)*Math.asin(1/a);return this.interpolated.set(d,-(a*Math.pow(2,10*(d-=1))*Math.sin((d-e)*2*Math.PI/b)))};return this},
createElasticInOutInterpolator:function(a,b,c){this.getPosition=function(d){if(c)if(d<0.5)d*=2;else d=1-(d-0.5)*2;var e=b/(2*Math.PI)*Math.asin(1/a);d*=2;if(d<=1)return this.interpolated.set(d,-0.5*a*Math.pow(2,10*(d-=1))*Math.sin((d-e)*2*Math.PI/b));return this.interpolated.set(d,1+0.5*a*Math.pow(2,-10*(d-=1))*Math.sin((d-e)*2*Math.PI/b))};return this},bounce:function(a){return(a/=1)<1/2.75?{x:a,y:7.5625*a*a}:a<2/2.75?{x:a,y:7.5625*(a-=1.5/2.75)*a+0.75}:a<2.5/2.75?{x:a,y:7.5625*(a-=2.25/2.75)*a+
0.9375}:{x:a,y:7.5625*(a-=2.625/2.75)*a+0.984375}},createBounceOutInterpolator:function(a){this.getPosition=function(b){if(a)if(b<0.5)b*=2;else b=1-(b-0.5)*2;return this.bounce(b)};return this},createBounceInInterpolator:function(a){this.getPosition=function(b){if(a)if(b<0.5)b*=2;else b=1-(b-0.5)*2;b=this.bounce(1-b);b.y=1-b.y;return b};return this},createBounceInOutInterpolator:function(a){this.getPosition=function(b){if(a)if(b<0.5)b*=2;else b=1-(b-0.5)*2;if(b<0.5){b=this.bounce(1-b*2);b.y=(1-b.y)*
0.5;return b}b=this.bounce(b*2-1,a);b.y=b.y*0.5+0.5;return b};return this},paint:function(a){a=a.crc;a.save();a.beginPath();a.moveTo(0,this.getPosition(0).y*this.paintScale);for(var b=0;b<=this.paintScale;b++)a.lineTo(b,this.getPosition(b/this.paintScale).y*this.paintScale);a.strokeStyle="black";a.stroke();a.restore()},getContour:function(a){for(var b=[],c=0;c<=a;c++)b.push({x:c/a,y:this.getPosition(c/a).y});return b}}})();(function(){CAAT.InterpolatorActor=function(){CAAT.InterpolatorActor.superclass.constructor.call(this);return this};extend(CAAT.InterpolatorActor,CAAT.Actor,{interpolator:null,contour:null,S:50,gap:2,setInterpolator:function(a,b){this.interpolator=a;this.contour=a.getContour(b||this.S);return this},paint:function(a,b){CAAT.InterpolatorActor.superclass.paint.call(this,a,b);if(this.interpolator){var c=a.crc;c.beginPath();c.moveTo(this.gap+this.contour[0].x*(this.width-2*this.gap),-this.gap+this.height-
this.contour[0].y*(this.height-2*this.gap));for(var d=1;d<this.contour.length;d++)c.lineTo(this.gap+this.contour[d].x*(this.width-2*this.gap),-this.gap+this.height-this.contour[d].y*(this.height-2*this.gap));c.strokeStyle="black";c.stroke()}},getInterpolator:function(){return this.interpolator}})})();
